{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}Cleveland Tech Survey{% endblock %}

{% block page_content %}
<div class="page-header">
    <h1>Welcome to the Cleveland Tech Survey!</h1>
    <h3>Total Respondents: {{ num_respondents }}</h3>
</div>
<nav class="col-md-3 sidebar-offcanvas" id="myScrollspy">
    <div class="panel list-group" data-spy="affix" data-offset-top="205">
        {% for category in categories %}
        <a href="#" class="list-group-item" data-toggle="collapse" data-target="#{{ category }}" data-parent="#menu">{{ category }} <span class="caret"></span></a>
        <div id="{{ category }}" class="collapse">
            <h6>{{ category }}</h6>
            {% for cat, title in cats_and_titles %}
                {% if cat == category %}
                <a href="#{{ id }}" class="list-group-item">{{ title }}</a>
                {% else %}
                <a href="#{{ id }}" class="list-group-item">**ERROR** category is {{ category }} when it should be {{ cat }}</a>
                {% endif %}
            {% endfor %}
        </div>
        {% endfor %}
        <a href="#" class="list-group-item">Top</a>
    </div>
</nav>
<!--<nav class="col-md-3 sidebar-offcanvas" id="myScrollspy">-->
    <!--<div class="panel list-group" data-spy="affix" data-offset-top="205">-->
        <!--<a href="#" class="list-group-item" data-toggle="collapse" data-target="#sl" data-parent="#menu">Results <span class="caret"></span></a>-->
        <!--<div id="sl" class="collapse">-->
            <!--{% for id, title in ids_and_titles %}-->
            <!--<a href="#{{ id }}" class="list-group-item">{{ title }}</a>-->
            <!--{% endfor %}-->
            <!--<a href="#" class="list-group-item">Top</a>-->
        <!--</div>-->
    <!--</div>-->
<!--</nav>-->
<div class="col-md-9 pull-right">
    {% for id, title in ids_and_titles %}
    <div id="{{ id }}"></div>
    {% endfor %}
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<!-- D3.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<!-- Plotly.js -->
<script src="https://d14fo0winaifog.cloudfront.net/plotly-basic.js"></script>

<script type="text/javascript">
    var graphs = {{ graphJSON | safe }};
    var ids = {{ ids | safe }};
    for(var id in graphs) {
        Plotly.plot(ids[id],
                    graphs[id].data,
                    graphs[id].layout,
                    {showLink: false,
                    displayModeBar: false});
    }
</script>
<script>
$(document).ready(function() {
    $("nav a").on('click', function(event) {
        if (this.hash !== "") {
            event.preventDefault();
            var hash = this.hash;
            $('html, body').animate({
                scrollTop: $(hash).offset().top
            }, 333, function() {
                window.location.hash = hash;
            });
        }
    });
})
</script>
{% endblock %}

