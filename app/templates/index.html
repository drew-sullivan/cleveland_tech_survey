{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}Cleveland Tech Survey{% endblock %}

{% block head %}
{{ super() }}
<!-- D3.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<!-- Plotly.js -->
<script src="https://d14fo0winaifog.cloudfront.net/plotly-basic.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $('.nav-tabs li').on('click', function(e) {
            e.preventDefault();
            var scrollTo = $('.nav-tabs');
            console.log(scrollTo)
            $('html, body').animate({
               scrollTop: $(scrollTo).offset().top
            }, 500);
            $.ajax({
                url: "{{ url_for('main.data_post') }}",
                method: "POST",
                data: JSON.stringify($(this).attr("value")),
                contentType: 'application/json;charset=UTF-8',
                success: function(python) {
                    var graph = python.graph_dict;

                    <!--var scrollTo = $('.nav-tabs');-->
                    <!--console.log(scrollTo)-->
                    <!--$('html, body').animate({-->
                        <!--scrollTop: $(scrollTo).offset().top-->
                    <!--}, 500);-->

                    $chart = $('#chart');
                    $chart.remove()
                    $('<div/>',{ id : 'chart', href: '#_'}).appendTo(".tab-pane");
                    Plotly.plot('chart', // the ID of the div
                                graph.data,
                                graph.layout || {},
                                graph["show_link"]);
                }
            })
        });
    });
</script>
<!--<script>-->
<!--$(document).ready(function(){-->
  <!--// Add smooth scrolling to all links in navbar + footer link-->
  <!--$('.nav-tabs li').on('click', function(event) {-->

   <!--// Make sure this.hash has a value before overriding default behavior-->
  <!--if (this.hash !== "") {-->

    <!--// Prevent default anchor click behavior-->
    <!--event.preventDefault();-->

    <!--// Store hash-->
    <!--var hash = this.hash;-->

    <!--// Using jQuery's animate() method to add smooth page scroll-->
    <!--// The optional number (900) specifies the number of milliseconds it takes to scroll to the specified area-->
    <!--$('html, body').animate({-->
      <!--scrollTop: $(hash).offset().top-->
    <!--}, 900, function(){-->

      <!--// Add hash (#) to URL when done scrolling (default click behavior)-->
      <!--window.location.hash = hash;-->
      <!--});-->
    <!--} // End if-->
  <!--});-->
<!--})-->
<!--</script>-->
{% endblock %}

{% block page_content %}
<div class="page-header">
    <h1>Welcome to the Cleveland Tech Survey!</h1>
    <h3>Total Respondents: {{ num_respondents }}</h3>
</div>
<ul class="nav nav-tabs">
    <li class="active" id="welcomeTab" name="button_name_1" value="welcome">
        <a data-toggle="tab" href=".tab-pane">Home</a>
    </li>
    {% for id, title in ids_and_titles %}
    <li class="title-tab" id="graph-{{ id }}" name='button_{{ id }}_name' value="{{ title }}">
        <a href=".nav-tabs" data-toggle="tab">{{ title }}</a>
    </li>
    {% endfor %}
</ul>

<div class="tab-content" id="current-tab">
    <div id="welcome" class="tab-pane active">
        <div id="chart" style="height: 500px;">Please select one of the tabs to see how everyone has been responding.</div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript">
    <!--(function() {-->
    <!--var d3 = Plotly.d3;-->

    <!--var WIDTH_IN_PERCENT_OF_PARENT = 60,-->
        <!--HEIGHT_IN_PERCENT_OF_PARENT = 80;-->

    <!--var gd3 = d3.select('body')-->
        <!--.append('div')-->
        <!--.style({-->
            <!--width: WIDTH_IN_PERCENT_OF_PARENT + '%',-->
            <!--'margin-left': (100 - WIDTH_IN_PERCENT_OF_PARENT) / 2 + '%',-->

            <!--height: HEIGHT_IN_PERCENT_OF_PARENT + 'vh',-->
            <!--'margin-top': (100 - HEIGHT_IN_PERCENT_OF_PARENT) / 2 + 'vh'-->
        <!--});-->

    <!--var gd = gd3.node();-->

    <!--Plotly.plot(gd, [{-->
        <!--type: 'bar',-->
        <!--x: [1, 2, 3, 4],-->
        <!--y: [5, 10, 2, 8],-->
        <!--marker: {-->
            <!--color: '#C8A2C8',-->
            <!--line: {-->
                <!--width: 2.5-->
            <!--}-->
        <!--}-->
    <!--}], {-->
        <!--title: 'Auto-Resize',-->
        <!--font: {-->
            <!--size: 16-->
        <!--}-->
    <!--});-->

    <!--window.onresize = function() {-->
        <!--Plotly.Plots.resize(gd);-->
    <!--};-->

    <!--})();-->
</script>
<script>
$(document).ready(function(){
  // Add smooth scrolling to all links in navbar + footer link
  $(".title-tab").on('click', function(event) {

   // Make sure this.hash has a value before overriding default behavior
  if (this.hash !== "") {

    // Prevent default anchor click behavior
    event.preventDefault();

    // Store hash
    var hash = this.hash;

    // Using jQuery's animate() method to add smooth page scroll
    // The optional number (900) specifies the number of milliseconds it takes to scroll to the specified area
    $('html, body').animate({
      scrollTop: $(hash).offset().top
    }, 900, function(){

      // Add hash (#) to URL when done scrolling (default click behavior)
      window.location.hash = hash;
      });
    } // End if
  });
})
</script>
{% endblock %}

